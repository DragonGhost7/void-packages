# Template file for 'python3-dnspython'
pkgname=python3-dnspython
version=2.4.2
revision=1
build_style=python3-pep517
hostmakedepends="python3-setuptools python3-poetry-core"
depends="python3"
checkdepends="python3-attrs python3-async_generator python3-idna python3-curio
 python3-trio python3-outcome python3-sniffio python3-sortedcontainers
 python3-requests python3-requests-toolbelt python3-pytest iana-etc"
short_desc="DNS toolkit for Python3"
maintainer="DragonGhost7 <darkiridiumghost@gmail.com>"
license="ISC"
homepage="https://www.dnspython.org/"
distfiles="https://github.com/rthalley/dnspython/archive/refs/tags/v2.4.2.tar.gz"
checksum=439668b71103d5ecab87ab8fd72ea7ea0e2dff6c4679b325cc42daa86acdded1
# Some tests not working
make_check=extended

do_check() {
	# All tests should work again in version 2.1.1 or 2.2.0 (https://github.com/rthalley/dnspython/issues/622)
	PYTHONPATH=$(cd build/lib* && pwd) pytest -k 'not test_unpickle'
}

post_install() {
	vlicense LICENSE
}
